(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c8845"],{"54e5":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.didLoad?i("div",{staticClass:"nj-article-show"},[i("div",{staticClass:"nj-avatar",on:{click:function(e){return t.authorClick(t.Article.authorId)}}},[i("img",{attrs:{src:t.converter.avatarPath(t.Article.avatar)}})]),i("h1",{staticClass:"nj-tit",domProps:{innerHTML:t._s(t.converter.rn2htmlbr(t.Article.title))}}),i("h2",{staticClass:"nj-author"},[t._v("\n    "+t._s(t.Article.writetime)+" | "+t._s(t.Article.authorname)+"\n  ")]),"image"===t.Article.type?i("div",{staticClass:"nj-images"},t._l(t.Article.images,function(e,s){return i("img",{key:s,style:t.converter.imageStyle(t.Article.images.length),attrs:{src:t.converter.ossPath(t.Article.writetime,t.Article.Id,e)+t.converter.AliOssThumb["img"+Math.min(3,t.Article.images.length)]},on:{click:function(e){return t.imgClick(s)}}})}),0):t._e(),"video"===t.Article.type?i("div",{staticClass:"nj-video"},[i("img",{style:{height:t.videoHeight+"px"},attrs:{src:t.converter.ossPath(t.Article.writetime,t.Article.Id,t.Article.videos[0].fname)+t.converter.AliOssThumb["video"]}}),i("v-icon",{attrs:{color:"#ffffff",size:"50"},on:{click:function(e){return t.videoClick()}}},[t._v("play_circle_filled")]),i("span",{staticClass:"duration"},[t._v(t._s(t.converter.durationString(t.Article.videos[0].duration)))])],1):t._e(),"rich"===t.Article.type?i("div",{staticClass:"nj-content",domProps:{innerHTML:t._s(t.Article.content)}}):t._e(),""!==t.Article.postAddr?i("div",{staticClass:"nj-postAddr"},[i("v-icon",{staticClass:"nj-place"},[t._v("place")]),t._v("\n    "+t._s(t.Article.postAddr)+"\n  ")],1):t._e(),i("div",{staticStyle:{margin:"50px 0 150px 0"}},[i("nj-comments",{ref:"comments",attrs:{targetId:t.Article.Id,authorId:t.Article.authorId},on:{onReply:t.commentReply,onPosted:t.commentPosted,onAlert:t.commentAlert,onError:t.commentError}})],1),i("div",{directives:[{name:"show",rawName:"v-show",value:t.showOverlay,expression:"showOverlay"}],staticClass:"main-overlayer",on:{click:function(e){t.showOverlay=!1}}})]):t._e()},c=[],r=(i("456d"),i("ac6a"),i("132d")),n=i("b893"),a=i("e62a"),o={components:{VIcon:r["a"],"nj-comments":a["a"]},data:function(){return{initOnce:!1,didLoad:!1,converter:n["a"],showOverlay:!1,Article:{Id:-1,title:"",type:"rich",authorId:"",authorname:"",avatar:1,status:0,writetime:"",postAddr:"",content:"",images:[],videos:[],liked:!1},videoHeight:250}},created:function(){window.nativeCallJs=this.nativeCallJs},methods:{jsCallNative:function(t){"ios"==this.$store.getters.device.env&&window.webkit.messageHandlers.jsCallNative.postMessage(t),"android"==this.$store.getters.device.env&&window.android.jsCallAndroid(t)},nativeCallJs:function(t){switch(t.cmd){case"init":this.initOnce||(this.initOnce=!0,this.$store.commit("setSession",t.session),this.$store.commit("setConfig",t.config),this.$store.commit("setDevice",t.device),this.getArticle(t.params.articleId),this.videoHeight=9*(this.$store.getters.device.width-40)/16);break;case"refreshToken":this.$store.commit("setSession",{token:t.token});break;case"postComment":this.$refs.comments.postComment(t.content,t.isReplySubject);break;case"setOverlay":this.showOverlay=t.display;break}},getArticle:function(t){var e=this;this.$Ajax({method:"get",url:"/articles/".concat(t)}).then(function(t){t.data.ret<0?e.jsCallNative('{"cmd":"error","msg":"'.concat(t.data.msg,'"}')):(Object.keys(e.Article).forEach(function(i){t.data.article[i]&&(e.Article[i]=t.data.article[i])}),e.didLoad=!0,e.jsCallNative('{"cmd":"didLoad"}'),e.$store.getters.session.uid>0&&e.jsCallNative('{"cmd":"setLike","msg": "'.concat(e.Article.liked,'"}')),"rich"===e.Article.type&&e.makeRichTextImgClick())}).catch(function(t){e.jsCallNative('{"cmd":"error","msg":"网络好像有点问题"}')})},authorClick:function(){this.jsCallNative('{"cmd":"authorClick","authorId":'+this.Article.authorId+"}")},imgClick:function(t){var e=JSON.stringify(this.Article.images);this.jsCallNative('{"cmd":"imgClick","startIndex":'.concat(t,',"writetime":"').concat(this.Article.writetime,'","list":').concat(e,"}"))},videoClick:function(){var t=this.converter.ossPath(this.Article.writetime,this.Article.Id,this.Article.videos[0].fname);this.jsCallNative('{"cmd":"videoClick","videoUrl":"'.concat(t,'"}'))},commentReply:function(t){this.jsCallNative('{"cmd":"reply","replyTo":"'.concat(t,'"}'))},commentPosted:function(){this.showOverlay=!1,this.jsCallNative('{"cmd":"posted"}')},commentAlert:function(t){this.jsCallNative('{"cmd":"alert","msg":"'.concat(t,'"}'))},commentError:function(t){"token-expired"===t?this.jsCallNative('{"cmd":"token-expired"}'):this.jsCallNative('{"cmd":"error","msg":"'.concat(t,'"}'))},makeRichTextImgClick:function(){var t=this;setTimeout(function(){for(var e=document.querySelectorAll("div.nj-content img.oss-image"),i=[],s=0;s<e.length;s++)i.push(e[s].src);i=JSON.stringify(i);for(var c=function(s){e[s].addEventListener("click",function(){t.jsCallNative('{"cmd":"richImageClick","startIndex":'.concat(s,',"list":').concat(i,"}"))},!1)},r=0;r<e.length;r++)c(r);var n=document.querySelectorAll("div.nj-content video.oss-video");n.forEach(function(e){e.poster=e.src+t.converter.AliOssThumb["video"]})},1e3)}}},l=o,d=i("2877"),m=Object(d["a"])(l,s,c,!1,null,null,null);e["default"]=m.exports}}]);